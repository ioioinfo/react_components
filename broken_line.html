<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
    <title>broken_line</title>
    <script src="js/jquery-3.1.1.min.js" type="text/javascript"></script>
    <style media="screen">
      #broken_line{
        text-align: center;
        padding-top: 70px;
      }
      #canvas{
        background: green;
      }
    </style>
  </head>
  <body>
    <div id="broken_line">
      <canvas id="canvas"></canvas>
    </div>

    <script type="text/javascript">
      var canvas = document.getElementById('canvas');
      var ctx = canvas.getContext('2d');
      var canvasWidth = 600;
      var canvasHeight = 400;
      canvas.width= canvasWidth;
      canvas.height = canvasHeight;
      var brokenDatas = ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'];
      var prointDatas = [20, 40, 80, 30, 70, 20, 90, 40, 70, 50, 10,70];
      var Heng = [];
      // 坐标轴
      function drawBorder() {
        ctx.save();
        ctx.beginPath();
        ctx.moveTo(40, 40);
        ctx.lineTo(40, 360);
        ctx.moveTo(20, 340);
        ctx.lineTo(560, 340);
        ctx.closePath();
        ctx.stroke();
        ctx.restore();
      }

      // 纵坐标数据
      function zongBroken(){
        ctx.save();
        var zongX = 30;
        var zongY = 340;
        var numY = 0;
        ctx.textAlign = 'end';
        for (var i = 0; i < 11; i++) {
          zongY = 340 - i* 290/10;
          numY = i* 10;
          ctx.moveTo(35, zongY)
          ctx.lineTo(40, zongY)
          ctx.fillText(numY, zongX, zongY);
          ctx.stroke();
          ctx.fill();
        }
        ctx.restore();

      }

      // 横坐标数据
      function hengBroken(){
        ctx.save();

        var hengY = 370;
        for (var i = 0; i < brokenDatas.length; i++) {
          var monthNum = brokenDatas[i];
          var textWidth = ctx.measureText(monthNum).width/2;

          var hengX = 40 + (i +1 )* 510/12;

          var lastHengX = hengX - textWidth;
          Heng.push(lastHengX)
          ctx.moveTo(hengX, 340);
          ctx.lineTo(hengX, 345);
          ctx.fillText(monthNum, lastHengX, hengY);
          ctx.stroke();
          ctx.fill();
        }
      }

      function dot(){
        ctx.save();
        for (var i = 0; i < prointDatas.length; i++) {
          var dotX =  Heng[i];
          var dotY = 290 - prointDatas[i];
          var dotX1 =  Heng[i+1];
          var dotY1 = 290 - prointDatas[i+1];
          ctx.beginPath();
          ctx.fillStyle = 'red';
          ctx.arc(dotX, dotY, 3, 0, 2*Math.PI);
          ctx.moveTo(dotX, dotY);
          ctx.lineTo(dotX1, dotY1);
          ctx.stroke();
          ctx.fill();
        }

      }

      window.onload = function(){
        drawBorder();
        zongBroken();
        hengBroken();
        dot();
      }
    </script>
  </body>
</html>
